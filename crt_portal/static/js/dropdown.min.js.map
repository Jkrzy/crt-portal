{"version":3,"file":"dropdown.min.js","sources":["dropdown.js"],"sourcesContent":["(function() {\n  /**\n   * Controls the visibility of a dropdown component\n   * @param {HTMLElement} el Node that represents the dropdown\n   */\n  function Dropdown(el) {\n    var el = el;\n    var control = el.querySelector('[data-crt-dropdown-control]');\n    var content = el.querySelector('.content');\n    var isVisible = true;\n\n    return {\n      get el() {\n        return el;\n      },\n      get control() {\n        return control;\n      },\n      get isVisible() {\n        return isVisible;\n      },\n      hide: function() {\n        isVisible = false;\n        content.setAttribute('hidden', '');\n        control.setAttribute('aria-expanded', isVisible);\n        el.classList.remove('expanded');\n      },\n      show: function() {\n        isVisible = true;\n        content.removeAttribute('hidden');\n        control.setAttribute('aria-expanded', isVisible);\n        el.classList.add('expanded');\n      }\n    };\n  }\n\n  var dropdownNodes = Array.prototype.slice.call(document.querySelectorAll('[data-crt-dropdown]'));\n  var dropdowns = dropdownNodes.map(function(node) {\n    var dropdown = Dropdown(node);\n    dropdown.hide();\n\n    return dropdown;\n  });\n\n  function dropdownToggle(dropdown) {\n    if (!dropdown) {\n      return;\n    }\n\n    if (dropdown.isVisible) {\n      dropdown.hide();\n    } else {\n      closeAllDropdowns();\n      dropdown.show();\n    }\n  }\n\n  function closeAllDropdowns() {\n    dropdowns.forEach(function(dropdown) {\n      dropdown.hide();\n    });\n  }\n\n  function hasParentNode(node, isTargetParentFn, maxDepth) {\n    var max = maxDepth || 10;\n    var depth = 1;\n    var currNode = node.parentNode;\n\n    function isMaxDepth(node, currDepth) {\n      return node.tagName === 'BODY' || currDepth === max;\n    }\n\n    while (currNode) {\n      if (isMaxDepth(currNode, depth)) {\n        currNode = null;\n        break;\n      }\n\n      if (isTargetParentFn(currNode)) {\n        break;\n      }\n\n      currNode = currNode.parentNode;\n      depth += 1;\n    }\n\n    depth = 1;\n\n    return currNode;\n  }\n\n  document.body.addEventListener('click', function(event) {\n    /**\n     * Determine if the click event happened inside of a dropdown.\n     * If so, there are one of two paths we need to take.\n     *\n     * If the element clicked was inside the dropdown container, do nothing.\n     *\n     * If the element clicked was exactly a dropdown button:\n     *  and the element is already open: close it\n     *  otherwise, close all dropodowns and open the one being targeted\n     *\n     * When click events occur outside of a dropdown, close all open\n     * dropdowns\n     **/\n    var node = hasParentNode(event.target, function(n) {\n      if (!n.classList) {\n        return false;\n      }\n      for (var i = 0; i < n.classList.length; i++) {\n        if (n.classList[i].indexOf('crt-dropdown') === -1) {\n          return false;\n        } else {\n          return true;\n        }\n      }\n    });\n\n    if (!node) {\n      closeAllDropdowns();\n    } else {\n      // A node here indicates that the click event happened within a dropdown\n      var maybeDropdown = dropdowns.filter(function(dropdown) {\n        return dropdown.control === event.target;\n      })[0];\n\n      dropdownToggle(maybeDropdown);\n    }\n  });\n})(window);\n"],"names":["dropdowns","Array","prototype","slice","call","document","querySelectorAll","map","node","el","control","content","isVisible","dropdown","querySelector","hide","setAttribute","classList","remove","show","removeAttribute","add","closeAllDropdowns","forEach","hasParentNode","isTargetParentFn","maxDepth","currDepth","max","depth","currNode","parentNode","tagName","body","addEventListener","event","target","n","i","length","indexOf","maybeDropdown","filter","window"],"mappings":"CAAA,WAoCE,IACIA,EADgBC,MAAMC,UAAUC,MAAMC,KAAKC,SAASC,iBAAiB,wBAC3CC,IAAI,SAASC,GACzC,IAjCgBC,EAEZC,EACAC,EACAC,EA6BAC,GA/BAH,GADAD,EADYA,EAiCQD,GA/BPM,cAAc,+BAC3BH,EAAUF,EAAGK,cAAc,YAC3BF,GAAY,EAET,CACLH,SACE,OAAOA,GAETC,cACE,OAAOA,GAETE,gBACE,OAAOA,GAETG,KAAM,WACJH,GAAY,EACZD,EAAQK,aAAa,SAAU,IAC/BN,EAAQM,aAAa,gBAAiBJ,GACtCH,EAAGQ,UAAUC,OAAO,aAEtBC,KAAM,WACJP,GAAY,EACZD,EAAQS,gBAAgB,UACxBV,EAAQM,aAAa,gBAAiBJ,GACtCH,EAAGQ,UAAUI,IAAI,eAUrB,OAFAR,EAASE,OAEFF,IAgBT,SAASS,IACPtB,EAAUuB,QAAQ,SAASV,GACzBA,EAASE,SAIb,SAASS,EAAchB,EAAMiB,EAAkBC,GAC7C,IAI0BC,EAJtBC,EAAMF,GAAY,GAClBG,EAAQ,EACRC,EAAWtB,EAAKuB,WAMpB,KAAOD,GAAU,CACf,GALwBH,EAKCE,EAJD,SAITC,EAJHE,SAAsBL,IAAcC,EAIf,CAC/BE,EAAW,KACX,MAGF,GAAIL,EAAiBK,GACnB,MAGFA,EAAWA,EAASC,WACpBF,GAAS,EAKX,OAFAA,EAAQ,EAEDC,EAGTzB,SAAS4B,KAAKC,iBAAiB,QAAS,SAASC,GAc/C,IA7DsBtB,EA6DXW,EAAcW,EAAMC,OAAQ,SAASC,GAC9C,GAAKA,EAAEpB,UAAP,CAGK,IAAIqB,EAAI,EAAb,OAAgBA,EAAID,EAAEpB,UAAUsB,SACkB,IAA5CF,EAAEpB,UAAUqB,GAAGE,QAAQ,oBAYzBC,EAAgBzC,EAAU0C,OAAO,SAAS7B,GAC5C,OAAOA,EAASH,UAAYyB,EAAMC,SACjC,IAhFiBvB,EAkFL4B,KA7Eb5B,EAASD,UACXC,EAASE,QAETO,IACAT,EAASM,UAkETG,MAvHN,CAiIGqB"}