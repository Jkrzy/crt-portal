{"version":3,"file":"modal.min.js","sources":["modal.js"],"sourcesContent":["(function(root, dom) {\n  root.CRT = root.CRT || {};\n\n  var previous_onkeydown = dom.onkeydown;\n  var focusable_elements =\n    'button, [href], input, select, textarea, [tabindex]:not([tabindex=\"-1\"])';\n\n  root.CRT.openModal = function(modal_el) {\n    dom.onkeydown = function(event) {\n      event = event || window.event;\n      var isEscape = false;\n      if ('key' in event) {\n        isEscape = event.key === 'Escape' || event.key === 'Esc';\n      } else {\n        isEscape = event.keyCode === 27;\n      }\n      if (isEscape) {\n        root.CRT.closeModal(modal_el);\n      }\n      var isTab = false;\n      if ('key' in event) {\n        isTab = event.key === 'Tab';\n      } else {\n        isTab = event.keyCode === 9;\n      }\n      if (isTab) {\n        var first = modal_el.querySelectorAll(focusable_elements)[0];\n        var focusable_content = modal_el.querySelectorAll(focusable_elements);\n        var last = focusable_content[focusable_content.length - 1];\n        if (event.shiftKey) {\n          // browse clickable elements moving backwards\n          if (document.activeElement === first) {\n            last.focus();\n            event.preventDefault();\n          }\n        } else {\n          // browse clickable elements moving forwards\n          if (document.activeElement === last) {\n            first.focus();\n            event.preventDefault();\n          }\n        }\n      }\n    };\n    modal_el.removeAttribute('hidden');\n    // get first input in this modal so we can focus on it\n    var first = modal_el.querySelectorAll(focusable_elements)[0];\n    first.focus();\n    dom.body.classList.add('is-modal');\n  };\n\n  root.CRT.closeModal = function(modal_el) {\n    dom.onkeydown = previous_onkeydown;\n    modal_el.setAttribute('hidden', 'hidden');\n    dom.body.classList.remove('is-modal');\n  };\n\n  root.CRT.cancelModal = function(modal_el, cancel_el, form_el) {\n    var dismissModal = function(event) {\n      if (form_el) {\n        form_el.scrollIntoView({ behavior: 'smooth', block: 'end', inline: 'nearest' });\n        form_el.focus();\n      }\n      event.preventDefault();\n      root.CRT.closeModal(modal_el);\n    };\n    cancel_el.addEventListener('click', dismissModal);\n  };\n})(window, document);\n"],"names":["root","dom","CRT","previous_onkeydown","onkeydown","focusable_elements","openModal","modal_el","event","window","key","keyCode","closeModal","first","last","querySelectorAll","focusable_content","length","shiftKey","document","activeElement","focus","preventDefault","removeAttribute","body","classList","add","setAttribute","remove","cancelModal","cancel_el","form_el","addEventListener","scrollIntoView","behavior","block","inline"],"mappings":"CAAA,SAAUA,EAAMC,GACdD,EAAKE,IAAMF,EAAKE,KAAO,GAEvB,IAAIC,EAAqBF,EAAIG,UACzBC,EACF,2EAEFL,EAAKE,IAAII,UAAY,SAASC,GAC5BN,EAAIG,UAAY,SAASI,IAGnB,QAFJA,EAAQA,GAASC,OAAOD,OAGG,WAAdA,EAAME,KAAkC,QAAdF,EAAME,IAEd,KAAlBF,EAAMG,UAGjBX,EAAKE,IAAIU,WAAWL,GAEtB,IAOMM,EAEAC,GARF,QAASN,EACW,QAAdA,EAAME,IAEY,IAAlBF,EAAMG,WAGVE,EAAQN,EAASQ,iBAAiBV,GAAoB,GAEtDS,GADAE,EAAoBT,EAASQ,iBAAiBV,IACrBW,EAAkBC,OAAS,GACpDT,EAAMU,SAEJC,SAASC,gBAAkBP,IAC7BC,EAAKO,QACLb,EAAMc,kBAIJH,SAASC,gBAAkBN,IAC7BD,EAAMQ,QACNb,EAAMc,oBAKdf,EAASgB,gBAAgB,UAEbhB,EAASQ,iBAAiBV,GAAoB,GACpDgB,QACNpB,EAAIuB,KAAKC,UAAUC,IAAI,aAGzB1B,EAAKE,IAAIU,WAAa,SAASL,GAC7BN,EAAIG,UAAYD,EAChBI,EAASoB,aAAa,SAAU,UAChC1B,EAAIuB,KAAKC,UAAUG,OAAO,aAG5B5B,EAAKE,IAAI2B,YAAc,SAAStB,EAAUuB,EAAWC,GASnDD,EAAUE,iBAAiB,QARR,SAASxB,GACtBuB,IACFA,EAAQE,eAAe,CAAEC,SAAU,SAAUC,MAAO,MAAOC,OAAQ,YACnEL,EAAQV,SAEVb,EAAMc,iBACNtB,EAAKE,IAAIU,WAAWL,MAhE1B,CAoEGE,OAAQU"}