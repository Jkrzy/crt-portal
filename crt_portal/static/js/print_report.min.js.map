{"version":3,"file":"print_report.min.js","sources":["print_report.js"],"sourcesContent":["(function(root, dom) {\n  var complaint_page = document.querySelector('.complaint-show-body');\n  var option_mapping_to_section = {\n    id_options_0: '.crt-correspondent-card',\n    id_options_1: '.crt-report-card',\n    id_options_2: '.crt-description-card',\n    id_options_3: '.crt-activities-card',\n    id_options_4: '.crt-summary-card'\n  };\n\n  var modal = document.getElementById('print_report');\n  var original_beforeprint = root.onbeforeprint;\n  var original_afterprint = root.onafterprint;\n  var showModal = function(event) {\n    event.preventDefault();\n    if (modal.getAttribute('hidden') !== null) {\n      // set up before and after print handlers so that we can\n      // selectively hide or show sections.\n      root.onbeforeprint = function(event) {\n        for (var option_id in option_mapping_to_section) {\n          var el = document.getElementById(option_id);\n          var classname = option_mapping_to_section[option_id];\n          var sections = complaint_page.querySelectorAll(classname);\n          if (!el.checked) {\n            sections.forEach(function(section) {\n              section.setAttribute('hidden', 'hidden');\n            });\n          }\n        }\n      };\n      root.onafterprint = function(event) {\n        for (var option_id in option_mapping_to_section) {\n          var el = document.getElementById(option_id);\n          var classname = option_mapping_to_section[option_id];\n          var sections = complaint_page.querySelectorAll(classname);\n          if (!el.checked) {\n            sections.forEach(function(section) {\n              section.removeAttribute('hidden');\n            });\n          }\n        }\n      };\n      root.CRT.openModal(modal);\n    } else {\n      // reset before and after print handlers.\n      root.onbeforeprint = original_beforeprint;\n      root.onafterprint = original_afterprint;\n      root.CRT.closeModal(modal);\n    }\n  };\n\n  var report = document.getElementById('printout_report');\n  report.addEventListener('click', showModal);\n\n  var cancel_modal = document.getElementById('print_report_cancel');\n  root.CRT.cancelModal(modal, cancel_modal);\n\n  // if no options are clicked, disable the print button.\n  var print_buttons = document.querySelectorAll('.print-report-button');\n  for (var option_id in option_mapping_to_section) {\n    var el = document.getElementById(option_id);\n    el.onclick = function(event) {\n      var selected = modal.querySelectorAll('input[type=checkbox]:checked');\n      for (var i = 0; i < print_buttons.length; i++) {\n        var print_button = print_buttons[i];\n        if (selected.length == 0) {\n          print_button.setAttribute('disabled', 'disabled');\n        } else {\n          print_button.removeAttribute('disabled');\n        }\n      }\n    };\n  }\n\n  for (var i = 0; i < print_buttons.length; i++) {\n    var print_button = print_buttons[i];\n    print_button.onclick = function(event) {\n      // display extra reports only if user hits \"print all\"\n      var print_all = event.target.value === 'print_all';\n      var extra_reports = document.querySelectorAll('.bulk-print-report-extra');\n      for (var j = 0; j < extra_reports.length; j++) {\n        var report = extra_reports[j];\n        if (print_all) {\n          report.removeAttribute('hidden');\n        } else {\n          report.setAttribute('hidden', 'hidden');\n        }\n      }\n      // hide the modal lest we print the modal itself.\n      dom.body.classList.remove('is-modal');\n      modal.setAttribute('hidden', 'hidden');\n      root.print();\n    };\n  }\n})(window, document);\n"],"names":["root","dom","complaint_page","document","querySelector","option_mapping_to_section","id_options_0","id_options_1","id_options_2","id_options_3","id_options_4","modal","getElementById","original_beforeprint","onbeforeprint","original_afterprint","onafterprint","addEventListener","event","preventDefault","getAttribute","option_id","el","sections","querySelectorAll","checked","forEach","section","setAttribute","removeAttribute","CRT","openModal","closeModal","cancel_modal","cancelModal","print_buttons","onclick","selected","i","length","print_button","print_all","target","value","extra_reports","j","report","body","classList","remove","print","window"],"mappings":"CAAA,SAAUA,EAAMC,GACd,IAAIC,EAAiBC,SAASC,cAAc,wBACxCC,EAA4B,CAC9BC,aAAc,0BACdC,aAAc,mBACdC,aAAc,wBACdC,aAAc,uBACdC,aAAc,qBAGZC,EAAQR,SAASS,eAAe,gBAChCC,EAAuBb,EAAKc,cAC5BC,EAAsBf,EAAKgB,aAuClBb,SAASS,eAAe,mBAC9BK,iBAAiB,QAvCR,SAASC,GACvBA,EAAMC,iBAC+B,OAAjCR,EAAMS,aAAa,WAGrBpB,EAAKc,cAAgB,SAASI,GAC5B,IAAK,IAAIG,KAAahB,EAA2B,CAC/C,IAAIiB,EAAKnB,SAASS,eAAeS,GAE7BE,EAAWrB,EAAesB,iBADdnB,EAA0BgB,IAErCC,EAAGG,SACNF,EAASG,QAAQ,SAASC,GACxBA,EAAQC,aAAa,SAAU,cAKvC5B,EAAKgB,aAAe,SAASE,GAC3B,IAAK,IAAIG,KAAahB,EAA2B,CAC/C,IAAIiB,EAAKnB,SAASS,eAAeS,GAE7BE,EAAWrB,EAAesB,iBADdnB,EAA0BgB,IAErCC,EAAGG,SACNF,EAASG,QAAQ,SAASC,GACxBA,EAAQE,gBAAgB,cAKhC7B,EAAK8B,IAAIC,UAAUpB,KAGnBX,EAAKc,cAAgBD,EACrBb,EAAKgB,aAAeD,EACpBf,EAAK8B,IAAIE,WAAWrB,MAOxB,IAAIsB,EAAe9B,SAASS,eAAe,uBAC3CZ,EAAK8B,IAAII,YAAYvB,EAAOsB,GAG5B,IACSZ,EADLc,EAAgBhC,SAASqB,iBAAiB,wBAC9C,IAASH,KAAahB,EACXF,SAASS,eAAeS,GAC9Be,QAAU,SAASlB,GAEpB,IADA,IAAImB,EAAW1B,EAAMa,iBAAiB,gCAC7Bc,EAAI,EAAGA,EAAIH,EAAcI,OAAQD,IAAK,CAC7C,IAAIE,EAAeL,EAAcG,GACV,GAAnBD,EAASE,OACXC,EAAaZ,aAAa,WAAY,YAEtCY,EAAaX,gBAAgB,cAMrC,IAAK,IAAIS,EAAI,EAAGA,EAAIH,EAAcI,OAAQD,IACrBH,EAAcG,GACpBF,QAAU,SAASlB,GAI9B,IAFA,IAAIuB,EAAmC,cAAvBvB,EAAMwB,OAAOC,MACzBC,EAAgBzC,SAASqB,iBAAiB,4BACrCqB,EAAI,EAAGA,EAAID,EAAcL,OAAQM,IAAK,CAC7C,IAAIC,EAASF,EAAcC,GACvBJ,EACFK,EAAOjB,gBAAgB,UAEvBiB,EAAOlB,aAAa,SAAU,UAIlC3B,EAAI8C,KAAKC,UAAUC,OAAO,YAC1BtC,EAAMiB,aAAa,SAAU,UAC7B5B,EAAKkD,SA3FX,CA8FGC,OAAQhD"}