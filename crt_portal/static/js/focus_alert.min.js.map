{"version":3,"file":"focus_alert.min.js","sources":["focus_alert.js"],"sourcesContent":["// Overwrites native 'firstElementChild' prototype.\n// Adds Document & DocumentFragment support for IE9 & Safari.\n(function(constructor) {\n  if (constructor && constructor.prototype && constructor.prototype.firstElementChild == null) {\n    Object.defineProperty(constructor.prototype, 'firstElementChild', {\n      get: function() {\n        var node,\n          nodes = this.childNodes,\n          i = 0;\n        while ((node = nodes[i++])) {\n          if (node.nodeType === 1) {\n            return node;\n          }\n        }\n        return null;\n      }\n    });\n  }\n})(window.Node || window.Element);\n\nfunction find_focusable(element) {\n  if (element.nodeName == 'INPUT' || element.nodeName == 'TEXTAREA') {\n    return element;\n  } else {\n    var element = element.firstElementChild;\n    return find_focusable(element);\n  }\n}\n\nfunction prepareErrors() {\n  // Find elements with class'usa-input--error'\n  var errors = document.getElementsByClassName('error-focus');\n  // add focus to first error\n  if (errors.length > 0) {\n    // add focus to the first error\n    var first_error = errors[0];\n    find_focusable(first_error).focus();\n    // read first error message\n    var error_message = document.getElementsByClassName('usa-alert__body')[0];\n    error_message.setAttribute('role', 'alert');\n    error_message.setAttribute('aria-live', 'assertive');\n  }\n}\n\nfunction triggerAlert() {\n  /**\n   * Wrapping this call in a setTimeout of zero schedules its execution\n   * at the beginning of the next JS frame's call stack. I'm not exactly sure\n   * why, but this allows the screen reader to see the 'error' messages.\n   */\n  setTimeout(prepareErrors, 0);\n}\n\nwindow.addEventListener('DOMContentLoaded', triggerAlert);\n"],"names":["find_focusable","element","nodeName","firstElementChild","prepareErrors","errors","document","getElementsByClassName","length","focus","error_message","setAttribute","triggerAlert","setTimeout","constructor","prototype","Object","defineProperty","get","node","nodes","this","childNodes","i","nodeType","window","Node","Element","addEventListener"],"mappings":"AAoBA,SAASA,eAAeC,GACtB,MAAwB,SAApBA,EAAQC,UAA2C,YAApBD,EAAQC,SAClCD,EAGAD,eADHC,EAAUA,EAAQE,mBAK1B,SAASC,gBAEP,IAAIC,EAASC,SAASC,uBAAuB,eAEzB,EAAhBF,EAAOG,SAGTR,eADkBK,EAAO,IACGI,SAExBC,EAAgBJ,SAASC,uBAAuB,mBAAmB,IACzDI,aAAa,OAAQ,SACnCD,EAAcC,aAAa,YAAa,cAI5C,SAASC,eAMPC,WAAWT,cAAe,IAhD5B,SAAUU,GACJA,GAAeA,EAAYC,WAAwD,MAA3CD,EAAYC,UAAUZ,mBAChEa,OAAOC,eAAeH,EAAYC,UAAW,oBAAqB,CAChEG,IAAK,WAIH,IAHA,IAAIC,EACFC,EAAQC,KAAKC,WACbC,EAAI,EACEJ,EAAOC,EAAMG,MACnB,GAAsB,IAAlBJ,EAAKK,SACP,OAAOL,EAGX,OAAO,QAZf,CAgBGM,OAAOC,MAAQD,OAAOE,SAmCzBF,OAAOG,iBAAiB,mBAAoBhB"}